(function(d,m){function s(a){return a.id&&d('label[for="'+a.id+'"]').val()||a.name}function B(a,b,c){c||(c=0);b.each(function(){var b=d(this),e=this,g=this.nodeName.toLowerCase(),k,h;"label"===g&&b.find("input, textarea, select").length&&(k=b.text(),b=b.children().first(),e=b.get(0),g=e.nodeName.toLowerCase());switch(g){case "menu":h={name:b.attr("label"),items:{}};c=B(h.items,b.children(),c);break;case "a":case "button":h={name:b.text(),disabled:!!b.attr("disabled"),callback:function(){b.click()}};
break;case "menuitem":case "command":switch(b.attr("type")){case m:case "command":case "menuitem":h={name:b.attr("label"),disabled:!!b.attr("disabled"),icon:b.attr("icon"),callback:function(){b.click()}};break;case "checkbox":h={type:"checkbox",disabled:!!b.attr("disabled"),name:b.attr("label"),selected:!!b.attr("checked")};break;case "radio":h={type:"radio",disabled:!!b.attr("disabled"),name:b.attr("label"),radio:b.attr("radiogroup"),value:b.attr("id"),selected:!!b.attr("checked")};break;default:h=
m}break;case "hr":h="-------";break;case "input":switch(b.attr("type")){case "text":h={type:"text",name:k||s(e),disabled:!!b.attr("disabled"),value:b.val()};break;case "checkbox":h={type:"checkbox",name:k||s(e),disabled:!!b.attr("disabled"),selected:!!b.attr("checked")};break;case "radio":h={type:"radio",name:k||s(e),disabled:!!b.attr("disabled"),radio:!!b.attr("name"),value:b.val(),selected:!!b.attr("checked")};break;default:h=m}break;case "select":h={type:"select",name:k||s(e),disabled:!!b.attr("disabled"),
selected:b.val(),options:{}};b.children().each(function(){h.options[this.value]=d(this).text()});break;case "textarea":h={type:"textarea",name:k||s(e),disabled:!!b.attr("disabled"),value:b.val()};break;case "label":break;default:h={type:"html",html:b.clone(!0)}}h&&(c++,a["key"+c]=h)});return c}d.support.htmlMenuitem="HTMLMenuItemElement"in window;d.support.htmlCommand="HTMLCommandElement"in window;d.support.eventSelectstart="onselectstart"in document.documentElement;if(!d.ui||!d.widget){var D=d.cleanData;
d.cleanData=function(a){var b,c,f;for(f=0;null!=a[f];f++){c=a[f];try{(b=d._data(c,"events"))&&b.remove&&d(c).triggerHandler("remove")}catch(e){}}D(a)}}var l=null,v=!1,q=d(window),w=0,r={},n={},x={},y={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",
iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit"},determinePosition:function(a){if(d.ui&&d.ui.position)a.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var b=this.offset();b.top+=this.outerHeight();b.left+=this.outerWidth()/2-a.outerWidth()/2;a.css(b)}},position:function(a,b,c){if(!b&&!c)a.determinePosition.call(this,
a.$menu);else{b="maintain"===b&&"maintain"===c?a.$menu.position():{top:c,left:b};c=q.scrollTop()+q.height();var d=q.scrollLeft()+q.width(),e=a.$menu.outerHeight(),g=a.$menu.outerWidth();b.top+e>c&&(b.top-=e);0>b.top&&(b.top=0);b.left+g>d&&(b.left-=g);0>b.left&&(b.left=0);a.$menu.css(b)}},positionSubmenu:function(a){if(d.ui&&d.ui.position)a.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var b={top:0,left:this.outerWidth()};a.css(b)}},
zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:d.noop,hide:d.noop},callback:null,items:{}},t=null,z=null,A=null,C,j={abortevent:function(a){a.preventDefault();a.stopImmediatePropagation()},contextmenu:function(a){var b=d(this);"right"===a.data.trigger&&(a.preventDefault(),a.stopImmediatePropagation());if((!("right"!==a.data.trigger&&"demand"!==a.data.trigger)||!a.originalEvent)&&(!(a.mouseButton!==m&&a.data)||"left"===a.data.trigger&&0===a.mouseButton||"right"===a.data.trigger&&
2===a.mouseButton)&&!b.hasClass("context-menu-active")&&!b.hasClass("context-menu-disabled")){l=b;if(a.data.build){var c=a.data.build(l,a);if(!1===c)return;a.data=d.extend(!0,{},y,a.data,c||{});if(!a.data.items||d.isEmptyObject(a.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),Error("No Items specified");a.data.$trigger=l;p.create(a.data)}var c=!1,f;for(f in a.data.items)a.data.items.hasOwnProperty(f)&&(d.isFunction(a.data.items[f].visible)?
a.data.items[f].visible.call(d(a.currentTarget),f,a.data):"undefined"!==typeof f.visible?!0===a.data.items[f].visible:1)&&(c=!0);c&&(null===a.data.appendTo?d("body"):d(a.data.appendTo),p.show.call(b,a.data,a.pageX,a.pageY))}},click:function(a){a.preventDefault();a.stopImmediatePropagation();d(this).trigger(d.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY}))},mousedown:function(a){var b=d(this);l&&(l.length&&!l.is(b))&&l.data("contextMenu").$menu.trigger("contextmenu:hide");2===a.button&&
(l=b.data("contextMenuActive",!0))},mouseup:function(a){var b=d(this);b.data("contextMenuActive")&&(l&&l.length&&l.is(b)&&!b.hasClass("context-menu-disabled"))&&(a.preventDefault(),a.stopImmediatePropagation(),l=b,b.trigger(d.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY})));b.removeData("contextMenuActive")},mouseenter:function(a){var b=d(this),c=d(a.relatedTarget),f=d(document);if(!c.is(".context-menu-list")&&!c.closest(".context-menu-list").length&&(!l||!l.length))z=a.pageX,A=a.pageY,
C=a.data,f.on("mousemove.contextMenuShow",j.mousemove),t=setTimeout(function(){t=null;f.off("mousemove.contextMenuShow");l=b;b.trigger(d.Event("contextmenu",{data:C,pageX:z,pageY:A}))},a.data.delay)},mousemove:function(a){z=a.pageX;A=a.pageY},mouseleave:function(a){a=d(a.relatedTarget);if(!a.is(".context-menu-list")&&!a.closest(".context-menu-list").length){try{clearTimeout(t)}catch(b){}t=null}},layerClick:function(a){var b=d(this).data("contextMenuRoot"),c=a.button,f=a.pageX,e=a.pageY,g,k;a.preventDefault();
a.stopImmediatePropagation();setTimeout(function(){var h,j="left"===b.trigger&&0===c||"right"===b.trigger&&2===c;document.elementFromPoint&&b.$layer&&(b.$layer.hide(),g=document.elementFromPoint(f-q.scrollLeft(),e-q.scrollTop()),b.$layer.show());if(b.reposition&&j)if(document.elementFromPoint){if(b.$trigger.is(g)||b.$trigger.has(g).length){b.position.call(b.$trigger,b,f,e);return}}else if(k=b.$trigger.offset(),h=d(window),k.top+=h.scrollTop(),k.top<=a.pageY&&(k.left+=h.scrollLeft(),k.left<=a.pageX&&
(k.bottom=k.top+b.$trigger.outerHeight(),k.bottom>=a.pageY&&(k.right=k.left+b.$trigger.outerWidth(),k.right>=a.pageX)))){b.position.call(b.$trigger,b,f,e);return}if(g&&j)b.$trigger.one("contextmenu:hidden",function(){d(g).contextMenu({x:f,y:e,button:c})});b.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var b={};l&&(b=l.data("contextMenu")||{});b.zIndex===m&&(b.zIndex=0);var c=0,d=function(a){""!==a.style.zIndex?c=a.style.zIndex:
null!==a.offsetParent&&a.offsetParent!==m?d(a.offsetParent):null!==a.parentElement&&a.parentElement!==m&&d(a.parentElement)};d(a.target);if(!(c>b.zIndex)){switch(a.keyCode){case 9:case 38:j.keyStop(a,b);if(b.isInput){if(9===a.keyCode&&a.shiftKey){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("prevcommand");return}if(38===a.keyCode&&"checkbox"===b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else if(9!==a.keyCode||
a.shiftKey){b.$menu.trigger("prevcommand");return}break;case 40:j.keyStop(a,b);if(b.isInput){if(9===a.keyCode){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("nextcommand");return}if(40===a.keyCode&&"checkbox"===b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else{b.$menu.trigger("nextcommand");return}break;case 37:j.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){a=
b.$selected.parent().parent();b.$selected.trigger("contextmenu:blur");b.$selected=a;return}break;case 39:j.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;var e=b.$selected.data("contextMenu")||{};if(e.$menu&&b.$selected.hasClass("context-menu-submenu")){b.$selected=null;e.$selected=null;e.$menu.trigger("nextcommand");return}break;case 35:case 36:if(!b.$selected||!b.$selected.find("input, textarea, select").length)(b.$selected&&b.$selected.parent()||b.$menu).children(":not(."+b.classNames.disabled+
", ."+b.classNames.notSelectable+")")[36===a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault();return;case 13:j.keyStop(a,b);if(b.isInput){if(b.$selected&&!b.$selected.is("textarea, select")){a.preventDefault();return}break}"undefined"!==typeof b.$selected&&null!==b.$selected&&b.$selected.trigger("mouseup");return;case 32:case 33:case 34:j.keyStop(a,b);return;case 27:j.keyStop(a,b);b.$menu.trigger("contextmenu:hide");return;default:if(e=String.fromCharCode(a.keyCode).toUpperCase(),
b.accesskeys&&b.accesskeys[e]){b.accesskeys[e].$node.trigger(b.accesskeys[e].$menu?"contextmenu:focus":"mouseup");return}}a.stopPropagation();"undefined"!==typeof b.$selected&&null!==b.$selected&&b.$selected.trigger(a)}},prevItem:function(a){a.stopPropagation();var b=d(this).data("contextMenu")||{},c=d(this).data("contextMenuRoot")||{};if(b.$selected){var f=b.$selected,b=b.$selected.parent().data("contextMenu")||{};b.$selected=f}for(var f=b.$menu.children(),e=!b.$selected||!b.$selected.prev().length?
f.last():b.$selected.prev(),g=e;e.hasClass(c.classNames.disabled)||e.hasClass(c.classNames.notSelectable)||e.is(":hidden");)if(e=e.prev().length?e.prev():f.last(),e.is(g))return;b.$selected&&j.itemMouseleave.call(b.$selected.get(0),a);j.itemMouseenter.call(e.get(0),a);a=e.find("input, textarea, select");a.length&&a.focus()},nextItem:function(a){a.stopPropagation();var b=d(this).data("contextMenu")||{},c=d(this).data("contextMenuRoot")||{};if(b.$selected){var f=b.$selected,b=b.$selected.parent().data("contextMenu")||
{};b.$selected=f}for(var f=b.$menu.children(),e=!b.$selected||!b.$selected.next().length?f.first():b.$selected.next(),g=e;e.hasClass(c.classNames.disabled)||e.hasClass(c.classNames.notSelectable)||e.is(":hidden");)if(e=e.next().length?e.next():f.first(),e.is(g))return;b.$selected&&j.itemMouseleave.call(b.$selected.get(0),a);j.itemMouseenter.call(e.get(0),a);a=e.find("input, textarea, select");a.length&&a.focus()},focusInput:function(){var a=d(this).closest(".context-menu-item"),b=a.data(),c=b.contextMenu,
b=b.contextMenuRoot;b.$selected=c.$selected=a;b.isInput=c.isInput=!0},blurInput:function(){var a=d(this).closest(".context-menu-item").data();a.contextMenuRoot.isInput=a.contextMenu.isInput=!1},menuMouseenter:function(){d(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(a){var b=d(this).data().contextMenuRoot;b.$layer&&b.$layer.is(a.relatedTarget)&&(b.hovering=!1)},itemMouseenter:function(a){var b=d(this),c=b.data(),f=c.contextMenu,c=c.contextMenuRoot;c.hovering=!0;a&&(c.$layer&&
c.$layer.is(a.relatedTarget))&&(a.preventDefault(),a.stopImmediatePropagation());(f.$menu?f:c).$menu.children("."+c.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur");b.hasClass(c.classNames.disabled)||b.hasClass(c.classNames.notSelectable)?f.$selected=null:b.trigger("contextmenu:focus")},itemMouseleave:function(a){var b=d(this),c=b.data(),f=c.contextMenu,c=c.contextMenuRoot;c!==f&&c.$layer&&c.$layer.is(a.relatedTarget)?("undefined"!==typeof c.$selected&&
null!==c.$selected&&c.$selected.trigger("contextmenu:blur"),a.preventDefault(),a.stopImmediatePropagation(),c.$selected=f.$selected=f.$node):b.trigger("contextmenu:blur")},itemClick:function(a){var b=d(this),c=b.data(),f=c.contextMenuRoot,e=c.contextMenuKey;if(c.contextMenu.items[e]&&!b.is("."+f.classNames.disabled+", .context-menu-submenu, .context-menu-separator, ."+f.classNames.notSelectable)){a.preventDefault();a.stopImmediatePropagation();if(d.isFunction(f.callbacks[e])&&Object.prototype.hasOwnProperty.call(f.callbacks,
e))a=f.callbacks[e];else if(d.isFunction(f.callback))a=f.callback;else return;!1!==a.call(f.$trigger,e,f)?f.$menu.trigger("contextmenu:hide"):f.$menu.parent().length&&p.update.call(f.$trigger,f)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(a,b){var c=d(this).data("contextMenuRoot");p.hide.call(c.$trigger,c,b&&b.force)},focusItem:function(a){a.stopPropagation();a=d(this);var b=a.data(),c=b.contextMenu,b=b.contextMenuRoot;!a.hasClass(b.classNames.disabled)&&!a.hasClass(b.classNames.notSelectable)&&
(a.addClass([b.classNames.hover,b.classNames.visible].join(" ")).parent().find(".context-menu-item").not(a).removeClass(b.classNames.visible).filter("."+b.classNames.hover).trigger("contextmenu:blur"),c.$selected=b.$selected=a,c.$node&&b.positionSubmenu.call(c.$node,c.$menu))},blurItem:function(a){a.stopPropagation();a=d(this);var b=a.data(),c=b.contextMenu,b=b.contextMenuRoot;c.autoHide&&a.removeClass(b.classNames.visible);a.removeClass(b.classNames.hover);c.$selected=null}},p={show:function(a,b,
c){var f=d(this),e={};d("#context-menu-layer").trigger("mousedown");a.$trigger=f;if(!1===a.events.show.call(f,a))l=null;else{p.update.call(f,a);a.position.call(f,a,b,c);if(a.zIndex){b=a.zIndex;"function"===typeof a.zIndex&&(b=a.zIndex.call(f,a));c=0;for(var g=f;!(c=Math.max(c,parseInt(g.css("z-index"),10)||0),g=g.parent(),!g||!g.length||-1<"html body".indexOf(g.prop("nodeName").toLowerCase())););e.zIndex=c+b}p.layer.call(a.$menu,a,e.zIndex);a.$menu.find("ul").css("zIndex",e.zIndex+1);a.$menu.css(e)[a.animation.show](a.animation.duration,
function(){f.trigger("contextmenu:visible")});f.data("contextMenu",a).addClass("context-menu-active");d(document).off("keydown.contextMenu").on("keydown.contextMenu",j.key);if(a.autoHide)d(document).on("mousemove.contextMenuAutoHide",function(b){var c=f.offset();c.right=c.left+f.outerWidth();c.bottom=c.top+f.outerHeight();a.$layer&&(!a.hovering&&(!(b.pageX>=c.left&&b.pageX<=c.right)||!(b.pageY>=c.top&&b.pageY<=c.bottom)))&&setTimeout(function(){a.hovering||a.$menu.trigger("contextmenu:hide")},50)})}},
hide:function(a,b){var c=d(this);a||(a=c.data("contextMenu")||{});if(b||!(a.events&&!1===a.events.hide.call(c,a))){c.removeData("contextMenu").removeClass("context-menu-active");if(a.$layer){var f=a.$layer;setTimeout(function(){f.remove()},10);try{delete a.$layer}catch(e){a.$layer=null}}l=null;a.$menu.find("."+a.classNames.hover).trigger("contextmenu:blur");a.$selected=null;a.$menu.find("."+a.classNames.visible).removeClass(a.classNames.visible);d(document).off(".contextMenuAutoHide").off("keydown.contextMenu");
if(a.$menu)a.$menu[a.animation.hide](a.animation.duration,function(){a.build&&(a.$menu.remove(),d.each(a,function(b){switch(b){case "ns":case "selector":case "build":case "trigger":return!0;default:a[b]=m;try{delete a[b]}catch(c){}return!0}}));setTimeout(function(){c.trigger("contextmenu:hidden")},10)})}},create:function(a,b){function c(a){var b=d("<span></span>");if(a._accesskey)a._beforeAccesskey&&b.append(document.createTextNode(a._beforeAccesskey)),d("<span></span>").addClass("context-menu-accesskey").text(a._accesskey).appendTo(b),
a._afterAccesskey&&b.append(document.createTextNode(a._afterAccesskey));else if(a.isHtmlName){if("undefined"!==typeof a.accesskey)throw Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");b.html(a.name)}else b.text(a.name);return b}b===m&&(b=a);a.$menu=d('<ul class="context-menu-list"></ul>').addClass(a.className||"").data({contextMenu:a,contextMenuRoot:b});d.each(["callbacks","commands","inputs"],function(c,e){a[e]={};b[e]||(b[e]={})});b.accesskeys||
(b.accesskeys={});d.each(a.items,function(f,e){var g=d('<li class="context-menu-item"></li>').addClass(e.className||""),k=null,h=null;g.on("click",d.noop);"string"===typeof e&&(e={type:"cm_seperator"});e.$node=g.data({contextMenu:a,contextMenuRoot:b,contextMenuKey:f});if("undefined"!==typeof e.accesskey){for(var l=e.accesskey.split(/\s+/),m=[],n=0,u;u=l[n];n++)u=u.charAt(0).toUpperCase(),m.push(u);for(l=0;n=m[l];l++)if(!b.accesskeys[n]){b.accesskeys[n]=e;if(m=e.name.match(RegExp("^(.*?)("+n+")(.*)$",
"i")))e._beforeAccesskey=m[1],e._accesskey=m[2],e._afterAccesskey=m[3];break}}if(e.type&&x[e.type])x[e.type].call(g,e,a,b),d.each([a,b],function(a,b){b.commands[f]=e;d.isFunction(e.callback)&&(b.callbacks[f]=e.callback)});else{"cm_seperator"===e.type?g.addClass("context-menu-separator "+b.classNames.notSelectable):"html"===e.type?g.addClass("context-menu-html "+b.classNames.notSelectable):e.type?(k=d("<label></label>").appendTo(g),c(e).appendTo(k),g.addClass("context-menu-input"),a.hasTypes=!0,d.each([a,
b],function(a,b){b.commands[f]=e;b.inputs[f]=e})):e.items&&(e.type="sub");switch(e.type){case "cm_seperator":break;case "text":h=d('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+f).val(e.value||"").appendTo(k);break;case "textarea":h=d('<textarea name=""></textarea>').attr("name","context-menu-input-"+f).val(e.value||"").appendTo(k);e.height&&h.height(e.height);break;case "checkbox":h=d('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+
f).val(e.value||"").prop("checked",!!e.selected).prependTo(k);break;case "radio":h=d('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+e.radio).val(e.value||"").prop("checked",!!e.selected).prependTo(k);break;case "select":h=d('<select name="">').attr("name","context-menu-input-"+f).appendTo(k);e.options&&(d.each(e.options,function(a,b){d("<option></option>").val(a).text(b).appendTo(h)}),h.val(e.selected));break;case "sub":c(e).appendTo(g);e.appendTo=e.$node;p.create(e,
b);g.data("contextMenu",e).addClass("context-menu-submenu");e.callback=null;break;case "html":d(e.html).appendTo(g);break;default:d.each([a,b],function(a,b){b.commands[f]=e;d.isFunction(e.callback)&&(b.callbacks[f]=e.callback)}),c(e).appendTo(g)}if(e.type&&("sub"!==e.type&&"html"!==e.type&&"cm_seperator"!==e.type)&&(h.on("focus",j.focusInput).on("blur",j.blurInput),e.events))h.on(e.events,a);e.icon&&(e._icon=d.isFunction(e.icon)?e.icon.call(this,this,g,f,e):"string"===typeof e.icon&&"fa-"==e.icon.substring(0,
3)?b.classNames.icon+" "+b.classNames.icon+"--fa fa "+e.icon:b.classNames.icon+" "+b.classNames.icon+"-"+e.icon,g.addClass(e._icon))}e.$input=h;e.$label=k;g.appendTo(a.$menu);if(!a.hasTypes&&d.support.eventSelectstart)g.on("selectstart.disableTextSelect",j.abortevent)});a.$node||a.$menu.css("display","none").addClass("context-menu-root");a.$menu.appendTo(a.appendTo||document.body)},resize:function(a,b){var c;a.css({position:"absolute",display:"block"});a.data("width",(c=a.get(0)).getBoundingClientRect?
Math.ceil(c.getBoundingClientRect().width):a.outerWidth()+1);a.css({position:"static",minWidth:"0px",maxWidth:"100000px"});a.find("> li > ul").each(function(){p.resize(d(this),!0)});b||a.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return d(this).data("width")})},update:function(a,b){var c=this;b===m&&(b=a,p.resize(a.$menu));a.$menu.children().each(function(){var f=d(this),e=f.data("contextMenuKey"),g=a.items[e],j=d.isFunction(g.disabled)&&g.disabled.call(c,
e,b)||!0===g.disabled,h;h=d.isFunction(g.visible)?g.visible.call(c,e,b):"undefined"!==typeof g.visible?!0===g.visible:!0;f[h?"show":"hide"]();f[j?"addClass":"removeClass"](b.classNames.disabled);d.isFunction(g.icon)&&(f.removeClass(g._icon),g._icon=g.icon.call(this,c,f,e,g),f.addClass(g._icon));if(g.type)switch(f.find("input, select, textarea").prop("disabled",j),g.type){case "text":case "textarea":g.$input.val(g.value||"");break;case "checkbox":case "radio":g.$input.val(g.value||"").prop("checked",
!!g.selected);break;case "select":g.$input.val(g.selected||"")}g.$menu&&p.update.call(c,g,b)})},layer:function(a,b){var c=a.$layer=d('<div id="context-menu-layer" style="position:fixed; z-index:'+b+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:q.height(),width:q.width(),display:"block"}).data("contextMenuRoot",a).insertBefore(this).on("contextmenu",j.abortevent).on("mousedown",j.layerClick);document.body.style.maxWidth===m&&c.css({position:"absolute",
height:d(document).height()});return c}};d.fn.contextMenu=function(a){var b=this;if(0<this.length)if(a===m)this.first().trigger("contextmenu");else if(a.x!==m&&a.y!==m)this.first().trigger(d.Event("contextmenu",{pageX:a.x,pageY:a.y,mouseButton:a.button}));else if("hide"===a){var c=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;c&&c.trigger("contextmenu:hide")}else"destroy"===a?d.contextMenu("destroy",{context:this}):d.isPlainObject(a)?(a.context=this,d.contextMenu("create",
a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");else d.each(n,function(){this.selector===b.selector&&(a.data=this,d.extend(a.data,{trigger:"demand"}))}),j.contextmenu.call(a.target,a);return this};d.contextMenu=function(a,b){"string"!==typeof a&&(b=a,a="create");"string"===typeof b?b={selector:b}:b===m&&(b={});var c=d.extend(!0,{},y,b||{}),f=d(document),e=f,g=!1;!c.context||!c.context.length?c.context=document:(e=d(c.context).first(),c.context=e.get(0),g=
c.context!==document);switch(a){case "create":if(!c.selector)throw Error("No selector specified");if(c.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+c.selector+'" as it contains a reserved className');if(!c.build&&(!c.items||d.isEmptyObject(c.items)))throw Error("No Items specified");w++;c.ns=".contextMenu"+w;g||(r[c.selector]=c.ns);n[c.ns]=c;c.trigger||(c.trigger="right");if(!v){var k={"contextmenu:focus.contextMenu":j.focusItem,"contextmenu:blur.contextMenu":j.blurItem,
"contextmenu.contextMenu":j.abortevent,"mouseenter.contextMenu":j.itemMouseenter,"mouseleave.contextMenu":j.itemMouseleave};k["click"===c.itemClickEvent?"click.contextMenu":"mouseup.contextMenu"]=j.itemClick;f.on({"contextmenu:hide.contextMenu":j.hideMenu,"prevcommand.contextMenu":j.prevItem,"nextcommand.contextMenu":j.nextItem,"contextmenu.contextMenu":j.abortevent,"mouseenter.contextMenu":j.menuMouseenter,"mouseleave.contextMenu":j.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",
".context-menu-input",j.inputClick).on(k,".context-menu-item");v=!0}e.on("contextmenu"+c.ns,c.selector,c,j.contextmenu);if(g)e.on("remove"+c.ns,function(){d(this).contextMenu("destroy")});switch(c.trigger){case "hover":e.on("mouseenter"+c.ns,c.selector,c,j.mouseenter).on("mouseleave"+c.ns,c.selector,c,j.mouseleave);break;case "left":e.on("click"+c.ns,c.selector,c,j.click)}c.build||p.create(c);break;case "destroy":var h;if(g){var l=c.context;d.each(n,function(b,a){if(a.context!==l)return!0;h=d(".context-menu-list").filter(":visible");
h.length&&h.data().contextMenuRoot.$trigger.is(d(a.context).find(a.selector))&&h.trigger("contextmenu:hide",{force:!0});try{n[a.ns].$menu&&n[a.ns].$menu.remove(),delete n[a.ns]}catch(c){n[a.ns]=null}d(a.context).off(a.ns);return!0})}else if(c.selector){if(r[c.selector]){h=d(".context-menu-list").filter(":visible");h.length&&h.data().contextMenuRoot.$trigger.is(c.selector)&&h.trigger("contextmenu:hide",{force:!0});try{n[r[c.selector]].$menu&&n[r[c.selector]].$menu.remove(),delete n[r[c.selector]]}catch(q){n[r[c.selector]]=
null}f.off(r[c.selector])}}else f.off(".contextMenu .contextMenuAutoHide"),d.each(n,function(a,b){d(b.context).off(b.ns)}),r={},n={},w=0,v=!1,d("#context-menu-layer, .context-menu-list").remove();break;case "html5":(!d.support.htmlCommand&&!d.support.htmlMenuitem||"boolean"===typeof b&&b)&&d('menu[type="context"]').each(function(){this.id&&d.contextMenu({selector:"[contextmenu="+this.id+"]",items:d.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+
a+'"');}return this};d.contextMenu.setInputValues=function(a,b){b===m&&(b={});d.each(a.inputs,function(a,d){switch(d.type){case "text":case "textarea":d.value=b[a]||"";break;case "checkbox":d.selected=b[a]?!0:!1;break;case "radio":d.selected=(b[d.radio]||"")===d.value;break;case "select":d.selected=b[a]||""}})};d.contextMenu.getInputValues=function(a,b){b===m&&(b={});d.each(a.inputs,function(a,d){switch(d.type){case "text":case "textarea":case "select":b[a]=d.$input.val();break;case "checkbox":b[a]=
d.$input.prop("checked");break;case "radio":d.$input.prop("checked")&&(b[d.radio]=d.value)}});return b};d.contextMenu.fromMenu=function(a){a=d(a);var b={};B(b,a.children());return b};d.contextMenu.defaults=y;d.contextMenu.types=x;d.contextMenu.handle=j;d.contextMenu.op=p;d.contextMenu.menus=n})(jQuery);
